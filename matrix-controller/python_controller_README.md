# LED Matrix Python Controller

LEDマトリックスをPythonからシリアル通信で制御するためのスクリプトです。コマンドライン版とGUI版の2種類があります。

## 機能

- 利用可能なシリアルポートの一覧表示
- シリアルポートへの接続
- 様々なアニメーションパターンの生成と送信
  - サンプルアニメーション（チェック柄パターン）
  - ランダムアニメーション
  - 波紋アニメーション

## 必要なライブラリ

このスクリプトを実行するには、以下のライブラリが必要です：

```bash
# コマンドライン版のみ
pip install pyserial

# GUI版の場合は追加で
pip install tkinter  # Pythonに標準で含まれていることが多いですが、念のため
```

## 使い方

### コマンドライン版

#### 基本的な実行方法

```bash
python python_controller.py
```

実行すると、利用可能なシリアルポートの一覧が表示され、接続するポートを選択できます。

#### コマンドラインオプション

```bash
python python_controller.py --port COM3 --baud 115200 --animation wave
```

- `--port`: シリアルポート名を指定（例：Windows なら `COM3`、Mac/Linux なら `/dev/ttyUSB0` など）
- `--baud`: ボーレートを指定（デフォルト: 115200）
- `--animation`: アニメーションタイプを指定（選択肢: `sample`, `random`, `wave`、デフォルト: `sample`）

### GUI版

#### 実行方法

```bash
python python_controller_gui.py
```

#### 操作手順

1. アプリケーションが起動したら、「更新」ボタンをクリックして利用可能なシリアルポートを表示します
2. ドロップダウンリストからシリアルポートを選択し、必要に応じてボーレートを設定します
3. 「接続」ボタンをクリックしてデバイスに接続します
4. アニメーションタイプを選択します（サンプル、ランダム、波紋）
5. 「アニメーション送信」ボタンをクリックしてデータを送信します
6. ログエリアに送信状況が表示されます
7. 終了時は「切断」ボタンをクリックしてから、アプリケーションを閉じます

## データ形式

このスクリプトは以下の形式でデータを送信します：

```
palette: #ffffff, #000000, ...
flame: 時間, 0, 1, 0, 1, ...
flame: 時間, 1, 0, 1, 0, ...
...
END
```

- `palette`: カンマ区切りのHEXカラーコードのリスト
- `flame`: 時間（ミリ秒）とカラーパレットのインデックス値のリスト
- `END`: データの終了を示すマーカー

## アニメーションタイプ

### サンプルアニメーション (`sample`)

赤/青と緑/黄色のチェック柄パターンが交互に切り替わるシンプルなアニメーション。

### ランダムアニメーション (`random`)

ランダムな色のピクセルで構成されるアニメーション。

### 波紋アニメーション (`wave`)

中心から外側に広がる波紋のようなアニメーション。

## トラブルシューティング

### シリアルポートが見つからない場合

- USBケーブルが正しく接続されているか確認してください
- デバイスドライバが正しくインストールされているか確認してください
- 別のUSBポートを試してみてください

### 接続エラーが発生する場合

- 他のアプリケーションがシリアルポートを使用していないか確認してください
- 正しいボーレートを指定しているか確認してください
- 管理者権限で実行してみてください（特にLinuxの場合）

### データ送信エラーが発生する場合

- 接続が安定しているか確認してください
- デバイス側がデータを受信する準備ができているか確認してください
